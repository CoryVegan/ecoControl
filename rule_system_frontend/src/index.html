<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Rule System!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

	<!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
	<!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
	<!--script src="js/less-1.3.3.min.js"></script-->
	<!--append ‘#!watch’ to the browser URL, then refresh the page. -->
	
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
	 <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
	 <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	 <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	 <script type="text/javascript" src="http://www.pureexample.com/js/lib/jquery.ui.touch-punch.min.js"></script>

	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/scripts.js"></script>

	<style>
			  .draggable { width: 300px; height: 80px; padding: 0.5em; }
			  .draggable_widgets{ width: 295px; height: 50px; padding: 0.5em; }
			  .snappable { width: 300px; height: 60px; padding: 0.5em; border: 4px dotted gray; }
			  #rule_container { width: 505px; height: 250px; padding: 0.5em; border: 3px dotted gray; }
			  .hovered { background: #aaa;}
			  #rule_creation_container {height: 250px; background: #aaa; border: 3px black;};
			  
			  
			   
	</style>

	<script>
	
	$(document).ready(function(){
		
		var rule_count = 1;
		var rule_drop_count = 0;

		handle_draggables();

		function handle_rule_drop( event, ui ) {
			 ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
			 ui.draggable.appendTo($(this.parent));
			 rule_drop_count+=1;
			 $(".panel-body").append(create_snappable());
			 handle_draggables();	

		};

		

		$("#new_rule_button").click(function(event) {
			rule_col = "#r1c"+(rule_count %3);
			$( rule_col ).append(create_rule_container);
			rule_count = rule_count+1;

			handle_draggables();			
		});


		function handle_draggables (){

			$(".draggable").draggable({
				snap: ".snappable",
				snapMode: "inner",
				snapTolerance: 70, 
				revert: 'invalid',

			});

			$('.snappable').droppable({
				accept: '.draggable',
      			hoverClass: 'hovered',
      			drop: handle_rule_drop

			});
		};

		function create_snappable(event, ui){
			return('<div id="snappable_'+rule_drop_count+'"class="snappable"></div>');
		};


		function create_rule_container(event, ui){
			return ('<div id = "draggable_container_'+ rule_count+'" class ="draggable ">\
							<div class="ui-widget-content draggable_widgets">\
								<div class="btn-group">\
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" \
									 class="btn btn-default dropdown-toggle"><span class="caret"></span></button>\
									<ul class="dropdown-menu">\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
									</ul>\
								</div>\
								<div class="btn-group">\
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" \
									 class="btn btn-default dropdown-toggle"><span class="caret"></span></button>\
									<ul class="dropdown-menu">\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
									</ul>\
								</div>\
								<div class="btn-group">\
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" \
									 class="btn btn-default dropdown-toggle"><span class="caret"></span></button>\
									<ul class="dropdown-menu">\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
										<li> <a href="#">Action</a></li>\
										<li class="disabled"><a href="#">Another action</a> </li>\
									</ul>\
								</div>\
							</div>\
						<div>\
					</div>')

		};
	});


	</script>

</head>


<body>
	<div class="container" id="a" align= "right">
		<div class="row">
			<button type="button" id= "new_rule_button" class="btn btn-success">
    			New rule</button>
 

		</div>
	</div>
	<div class="container" id="rule_creation_container">
		<div class="row">
			
				 	
										
				<!--<div class="container">
					<div class="row clearfix">
						<div class="col-md-12 column"> -->
					 <div id="r1c0"class="col-md-4">
  
						
						<div id = "draggable_container_0" class ="draggable">

							<div class="ui-widget-content draggable_widgets">

								<div class="btn-group">
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>
									<ul class="dropdown-menu">
										<li>
											<a href="#">Action</a>
										</li>
										<li class="disabled">
											<a href="#">Another action</a>
										</li>
										<li class="divider">
										</li>
										<li>
											<a href="#">Something else here</a>
										</li>
									</ul>
								</div>
								<div class="btn-group">
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>
									<ul class="dropdown-menu">
										<li>
											<a href="#">Action</a>
										</li>
										<li class="disabled">
											<a href="#">Another action</a>
										</li>
										<li class="divider">
										</li>
										<li>
											<a href="#">Something else here</a>
										</li>
									</ul>
								</div>
								<div class="btn-group">
									 <button class="btn btn-default">Action</button> <button data-toggle="dropdown" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>
									<ul class="dropdown-menu">
										<li>
											<a href="#">Action</a>
										</li>
										<li class="disabled">
											<a href="#">Another action</a>
										</li>
										<li class="divider">
										</li>
										<li>
											<a href="#">Something else here</a>
										</li>
									</ul>
								</div>
							</div><!--  widgets -->
						
						</div> <!-- draggable container-->
					</div> <!--  col 1 -->
					<div id="r1c1" class="col-md-4"></div>
  					<div id="r1c2"class="col-md-4"></div>
				</div>

			</div>
					<!--	</div>
					</div>
			</div>-->
		
		
		</div> <!-- rule_creation_container -->

		<!--
		<div class="container-fluid" id="rule_container">				
		</div> rule container --> 

		<div class= "container" >
			<div class="row">
		 
				<div class="panel-group" id="accordion">
			      <div class="panel panel-default">
			        <div class="panel-heading">
			          <h4 class="panel-title">
			            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse0">
			              <h4>Ruleset</h4>
			            </a>
			          </h4>
			        </div>
			       
			      </div>
			    </div>
			 

				 <div id="collapse0" class="accordion-body collapse">
				    <div class="panel-body">

			          	<div id="snappable_0"class="snappable">

			          		

						 
						</div>
			    	</div>
				 </div>

			</div>
		</div>


	
</body>
</html>
